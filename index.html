<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulario con Google Sheets</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h1>Enviar datos a Google Sheets</h1>
  <form id="dataForm">
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" name="nombre" required>
    
    <label for="correo">Correo:</label>
    <input type="email" id="correo" name="correo" required>
    
    <label for="mensaje">Mensaje:</label>
    <textarea id="mensaje" name="mensaje" required></textarea>
    
    <button type="submit">Enviar</button>
  </form>

  <h2>Datos Guardados:</h2>
  <ul id="savedData"></ul>

  <script>
    document.getElementById('dataForm').addEventListener('submit', function(event) {
      event.preventDefault();
      
      const nombre = document.getElementById('nombre').value;
      const correo = document.getElementById('correo').value;
      const mensaje = document.getElementById('mensaje').value;
      
      const data = {
        nombre: nombre,
        correo: correo,
        mensaje: mensaje
      };
      
      const scriptURL = 'https://script.google.com/macros/s/AKfycbzEMedn45_uTggdrTzp0XuETbuFIW3SraHt73BQZUpNV7pMmTlunEoXRPgsgJagr7Qe/exec';
    
      fetch(scriptURL, {
        method: 'GET',
        body: JSON.stringify(data),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.text();
      })
      .then(data => {
        alert(data); // Mensaje de Ã©xito
        obtenerDatos();
      })
      .catch(error => console.error('Error al enviar los datos:', error));
    });
    
    function obtenerDatos() {
      const scriptURL = 'https://script.google.com/macros/s/AKfycbzEMedn45_uTggdrTzp0XuETbuFIW3SraHt73BQZUpNV7pMmTlunEoXRPgsgJagr7Qe/exec';
    
      fetch(scriptURL)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          const lista = document.getElementById('savedData');
          lista.innerHTML = ''; // Limpiar lista antes de agregar nuevos datos
          
          data.forEach(row => {
            const listItem = document.createElement('li');
            listItem.textContent = `Nombre: ${row[0]}, Correo: ${row[1]}, Mensaje: ${row[2]}`;
            lista.appendChild(listItem);
          });
        })
        .catch(error => console.error('Error al obtener los datos:', error));
    }
    
    // Cargar los datos al inicio
    obtenerDatos();
  </script>
</body>
</html>
